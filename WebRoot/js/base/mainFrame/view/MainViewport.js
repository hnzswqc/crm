/*
 * File: mainFrame/view/MainViewport.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('mainFrame.view.MainViewport', {
    extend: 'Ext.container.Viewport',

    layout: {
        type: 'border'
    },

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'panel',
                    region: 'north',
                    split: true,
                    frame:true,
                    height: 50,
                    id: 'top',
                    frame:true,
                    collapsed: true,
                    collapsible: true,
                    header: false,
                    title: PRJ_TITLE,
                    //设置背景图片   
                    bodyStyle: {  
                       // background: '#6477B2'   
                        //background: 'url(img/login/top_bg.jpg)',  
                    } 
                   
                },
                {
                    xtype: 'panel',
                    region: 'west',
                    split: true,
                    id: 'left',
                    width: 200,
                    layout: {
                        type: 'accordion'
                    },
                    collapsible: true,
                    autoShow:true,
                    title: '菜单模块'
                },
                
                {
                    xtype: 'container',
                    region: 'center',
                    layout: {
                        type: 'border'
                    },
                    items: [
		                {
		                    xtype: 'tabpanel',
		                    region: 'center',
		                    id: 'center',
		                    activeTab: 0,
		                    items:[
		                           {
		                        	   xtype: 'panel',
	                                    border: false,
	                                    layout: {
		                        	   		align: 'stretch',
		                        	   		type: 'vbox'
	                                    },
	                                    bodyBorder: true,
	                                    collapsed: false,
	                                    collapsible: false,
	                                    headerPosition: 'bottom',
	                                    autoScroll: true,
	                                    title: '主界面',
	                                    items: [
											{
											    xtype: 'container',
											    flex: 1,
											    layout: {
											        align: 'stretch',
											        type: 'hbox'
											    },
											    margin:2,
											    items: [
											        {
											            xtype: 'panel',
											            flex: 1,
											            title: '部门员工统计图',
											            margin:2,
											            layout: {
									                        type: 'border'
									                    },
											            items:[
											                   {
								                                    xtype: 'chart',
								                                    animate: true,
								                                    insetPadding: 20,
								                                    draggable: true,
								                                    store: Ext.create("mainFrame.store.OrgUserListStore",{autoLoad:true}),
								                                    id:'OrgUserListChart',
								                                    axes: [
								                                        {
								                                            type: 'Category',
								                                            fields: [
								                                                'x'
								                                            ],
								                                            title: '部门',
								                                            fields: ['labelField'],
								                                            position: 'bottom'
								                                        },
								                                        {
								                                            type: 'Numeric',
								                                            fields: [
								                                                'y'
								                                            ],
								                                            title: '员工数量',
								                                            fields: ['dataField'],
								                                            position: 'left',
								                                            grid:true,
								                                            minimum: 0
								                                            
								                                        }
								                                    ],
								                                    series: [
								                                        {
								                                            type: 'column',
								                                            highlight : true,
								                                            tips: {  
								                                                trackMouse: true,  
								                                                width: 120,  
								                                                height: 25,  
								                                                renderer: function (storeItem, item) {  
								                                                    this.setTitle(storeItem.get('labelField') + ':' + storeItem.get('dataField')+'人');  
								                                                }  
								                                            },  
								                                            label: {
								                                                display: 'insideEnd',
								                                                field: 'dataField',
								                                                //color: '#333',
								                                                'text-anchor': 'middle',
								                                                renderer: Ext.util.Format.numberRenderer('0')
								                                            },
								                                            xField: 'labelField',
								                                            yField: 'dataField',
								                                            //此渲染器的存在能够使每条柱子的颜色，与上方声明的颜色数组相同         
								                                            renderer: function(sprite, storeItem, barAttr, i, store) {    
								                                            	//barAttr.fill ="#B2CEF2";
								                                            	return barAttr;           
								                                            } 
								                                        }
								                                    ]
								                                }
											            ],
											            tools: [
							                                {
							                                    xtype: 'tool',
							                                    handler: function(event, toolEl, owner, tool) {
							                                		Ext.getCmp("OrgUserListChart").store.removeAll();
							                                		Ext.getCmp("OrgUserListChart").store.load()
							                                    },
							                                    type: 'refresh'
							                                }
							                            ]
											        },
											        {
											            xtype: 'panel',
											            flex: 1,
											            title: '员工学历统计',
											            margin:2,
											            layout: {
									                        type: 'border'
									                    },
											            items:[
											                   {
								                                    xtype: 'chart',
								                                    animate: true,
								                                    insetPadding: 20,
								                                    draggable: true,
								                                    store: Ext.create("mainFrame.store.UserDegreesListStore",{autoLoad:true}),
								                                    id:'UserDegreesListChart',
								                                    axes: [
								                                        {
								                                            type: 'Category',
								                                            fields: [
								                                                'x'
								                                            ],
								                                            title: '学历',
								                                            fields: ['labelField'],
								                                            position: 'bottom'
								                                           
								                                        },
								                                        {
								                                            type: 'Numeric',
								                                            fields: [
								                                                'y'
								                                            ],
								                                            title: '员工数量',
								                                            fields: ['dataField'],
								                                            position: 'left',
								                                            grid:true,
								                                            minimum: 0
								                                            
								                                        }
								                                    ],
								                                    series: [
								                                        {
								                                            type: 'column',
								                                            highlight : true,
								                                            tips: {  
								                                                trackMouse: true,  
								                                                width: 120,  
								                                                height: 25,  
								                                                renderer: function (storeItem, item) {  
								                                                    this.setTitle(storeItem.get('labelField') + ':' + storeItem.get('dataField')+'人');  
								                                                }  
								                                            },  
								                                            label: {
								                                                display: 'insideEnd',
								                                                field: 'dataField',
								                                                color: '#444',
								                                                contrast : true,
								                                                'text-anchor': 'middle',
								                                                orientation:'horizontal',
								                                                renderer: Ext.util.Format.numberRenderer('0')
								                                            },
								                                            xField: 'labelField',
								                                            yField: 'dataField',
								                                            //此渲染器的存在能够使每条柱子的颜色，与上方声明的颜色数组相同         
								                                            renderer: function(sprite, storeItem, barAttr, i, store) {    
								                                            	//barAttr.fill ="#B2CEF2";
								                                            	return barAttr;           
								                                            } 
								                                        }
								                                    ]
								                                }
											            ],
											            tools: [
							                                {
							                                    xtype: 'tool',
							                                    handler: function(event, toolEl, owner, tool) {
							                                		Ext.getCmp("UserDegreesListChart").store.removeAll();
							                                		Ext.getCmp("UserDegreesListChart").store.load()
							                                    },
							                                    type: 'refresh'
							                                }
							                            ]
											        }
											    ]
											},
											{
											    xtype: 'container',
											    flex: 1,
											    layout: {
											        align: 'stretch',
											        type: 'hbox'
											    },
											    margin:2,
											    items: [
											        {
											            xtype: 'panel',
											            flex: 1,
											            title: '员工入职年限占比分析',
											            margin:2,
											            layout: {
									                        type: 'border'
									                    },
											            items:[
											                   {
								                                    xtype: 'chart',
								                                    animate: true,
								                                    insetPadding: 20,
								                                    draggable: true,
								                                    store: Ext.create("mainFrame.store.UserJoinYearListStore",{autoLoad:true}),
								                                    id:'UserJoinYearListChart',
								                                    legend: {             
											                	   		position: 'bottom'//在下方           
											                		},
								                                    series: [{
								                                        type: 'pie',
								                                        angleField: 'dataField',
								                                        showInLegend: true,
								                                        highlight : true,
								                                        tips: {
								                                            trackMouse: true,
								                                            width: 150,
								                                            height: 28,
								                                            renderer: function(storeItem, item) {
								                                                // calculate and display percentage on hover
								                                                var total = 0;
								                                                storeItem.store.each(function(rec) {
								                                                    total += rec.get('dataField');
								                                                });
								                                                this.setTitle(storeItem.get('labelField') + ': ' + Math.round(storeItem.get('dataField') / total * 100) + '%，共'+storeItem.get('dataField')+'人');
								                                            }
								                                        },
								                                        highlight: {
								                                            segment: {
								                                                margin: 20
								                                            }
								                                        },
								                                        label: {
								                                            field: 'labelField',
								                                            display: 'rotate',
								                                            contrast: true,
								                                            font: '18px Arial'
								                                        }
								                                    }]
								                                }
											            ],
											            tools: [
							                                {
							                                    xtype: 'tool',
							                                    handler: function(event, toolEl, owner, tool) {
							                                		Ext.getCmp("UserJoinYearListChart").store.removeAll();
							                                		Ext.getCmp("UserJoinYearListChart").store.load()
							                                    },
							                                    type: 'refresh'
							                                }
							                            ]
											        },
											        {
											            xtype: 'panel',
											            flex: 1,
											            title: '员工年龄占比分析',
											            margin:2,
											            layout: {
									                        type: 'border'
									                    },
											            items:[
											                   {
								                                    xtype: 'chart',
								                                    animate: true,
								                                    insetPadding: 20,
								                                    draggable: true,
								                                    store: Ext.create("mainFrame.store.UserAgeListStore",{autoLoad:true}),
								                                    id:'UserAgeListChart',
								                                    legend: {             
											                	   		position: 'bottom'//在下方           
											                		},
								                                    series: [{
								                                        type: 'pie',
								                                        angleField: 'dataField',
								                                        showInLegend: true,
								                                        highlight : true,
								                                        tips: {
								                                            trackMouse: true,
								                                            width: 150,
								                                            height: 28,
								                                            renderer: function(storeItem, item) {
								                                                // calculate and display percentage on hover
								                                                var total = 0;
								                                                storeItem.store.each(function(rec) {
								                                                    total += rec.get('dataField');
								                                                });
								                                                this.setTitle(storeItem.get('labelField') + ': ' + Math.round(storeItem.get('dataField') / total * 100) + '%，共'+storeItem.get('dataField')+'人');
								                                            }
								                                        },
								                                        highlight: {
								                                            segment: {
								                                                margin: 20
								                                            }
								                                        },
								                                        label: {
								                                            field: 'labelField',
								                                            display: 'rotate',
								                                            contrast: true,
								                                            font: '18px Arial'
								                                        }
								                                    }]
								                                }
											            ],
											            tools: [
							                                {
							                                    xtype: 'tool',
							                                    handler: function(event, toolEl, owner, tool) {
							                                		Ext.getCmp("UserAgeListChart").store.removeAll();
							                                		Ext.getCmp("UserAgeListChart").store.load()
							                                    },
							                                    type: 'refresh'
							                                }
							                            ]
											        }
											    ]
											},
	                                    ]
		                           }
		                    ],
		                    initEvents: function () {  
								 var tab = this;  
		                         var tabBar = tab.down("tabbar");
		                    	 tab.mon(tabBar.el,'dblclick',function(e,target,o){
		                    		 	var t = tab.getActiveTab();
		                    		 	if(t.title!='主界面')
		                        		tab.remove(tab.getActiveTab());
		        	            },this);  
			                 }
		                },
		                //快捷入口目前暂时隐藏
		                {
		                    xtype: 'panel',
		                    region: 'east',
		                    split: true,
		                    id: 'right',
		                    width: 100,
		                    collapsed: true,
		                    collapsible: true,
		                    title: '快捷入口',
		                    hidden:true
		                },
		                {
                            xtype: 'toolbar',
                            region: 'north',
                            //height: 40,
                            id:'toolbar',
                            margin: '2 2 2 0',
                            items: [
									{
									    xtype: 'displayfield',
									    //fieldLabel: '<span style=\'font-weight: bold;\'>当前登录人员</span>',
									    fieldLabel: '<img src=\'img/user.png\'/>',
									    labelWidth:18,
									    labelSeparator: ' ',
									    margin:'0 0 10 12',
									    id:'userName',
									    value: '',
									    fieldStyle: 'color:blue;font-weight: bold;'
									},
									{
									    xtype: 'displayfield',
									    //fieldLabel: '<span style=\'font-weight: bold;\'>当前登录人员</span>',
									    fieldLabel: '<img src=\'img/clock.png\'/>',
									    labelWidth:18,
									    labelSeparator: ' ',
									    id:'clock',
									    margin:'10 0 0 30',
									    fieldStyle: 'color:green;font-weight: bold;'
									},
                                    '->',
                                    {
                                   	 	xtype: 'button',
                                        text: '刷新',
                                        id:'refreshBtn',
                                        icon:'img/reload.png'
                                    },
                                    {
                                    	xtype: 'tbseparator'
                                    },
                                    {
                                    	xtype: 'button',
                                        text: '锁定',
                                        icon:'img/lock.png',
                                        hidden:true
                                    },
                                    {
                                    	xtype: 'tbseparator',
                                    	 hidden:true
                                    },
                                    {
                                    	xtype: 'button',
                                        text: CHANGE_USER_STATE!=""?"还原":"变身",
                                        id:'UserChangeBtn',
                                        icon:CHANGE_USER_STATE!=""?"img/user.png":"img/user_change.png"
                                    },
                                    {
                                    	xtype: 'tbseparator'
                                    },
                                    {
                                    	xtype: 'button',
                                        text: '当前在线',
                                        icon:'img/group.png',
                                        hidden:true
                                    },
                                    {
                                    	xtype: 'tbseparator',
                                        hidden:true
                                    },
                                    {
                                    	 xtype: 'button',
                                         text: '切换子系统',
                                         id:'ChangeSubsystemBtn',
                                         icon:'img/subsystem.png'
                                    },
                                    {
                                    	xtype: 'tbseparator'
                                    },
                                    {
                                   	 	xtype: 'button',
                                        text: '帮助',
                                        icon:'img/help.png',
                                        hidden:true
                                   },
                                   {
                                   	xtype: 'tbseparator',
                                    hidden:true
                                   },
                                   {
                                  	   xtype: 'button',
                                       text: '修改密码',
                                       id:'updPasswordBtn',
                                       icon:'img/key.png'
                                   },
                                   {
                                   	xtype: 'tbseparator'
                                   },
                                   {
                                  	   xtype: 'button',
                                       text: '退出',
                                       icon:'img/exit.png',
                                       id:'exit'
                                   }
                                ]
                        }
		             ]
                },
                {
                    xtype: 'panel',
                    region: 'south',
                    split: true,
                    frame: true,
                    height: 30,
                    id: 'bottom',
                    layout: {
                        align: 'center',
                        pack: 'center',
                        type: 'vbox'
                    },
                    collapsed: false,
                    collapsible: true,
                    header: false,
                    title: PRJ_TITLE,
                    titleAlign: 'center',
                    titleCollapse: false,
                    items: [
                        {
						    xtype: 'displayfield',
						    fieldLabel: '<span style=\'font-weight: bold;\'>版权所有</span>',
						    labelWidth: 70,
						    margin:'0 0 0 10',
						    value: 'CopyRight@2015'+PRJ_TITLE,
						    fieldStyle: 'color:blue;font-weight: bold;'
						}
                    ]
                }
            ]
        });

        me.callParent(arguments);
    }

});