/*
 * File: logs/view/LogsViewport.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('Logs.view.LogsViewport', {
    extend: 'Ext.container.Viewport',

    id: 'LogsViewport',
    layout: {
        type: 'border'
    },

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
				{
				    xtype: 'toolbar',
				    region: 'north',
				    //height: 40,
				    margin:2,
				    items: [
				        {
				            xtype: 'button',
				            id: 'Logs_refresh_btn',
				            icon: 'img/reload.png',
				            hidden:exists('Logs_refresh_btn'),
				            text: '刷新'
				        },
				        {
                        	xtype: 'tbseparator',
                        	 hidden:exists('Logs_refresh_btn')
                        },
				        {
				            xtype: 'button',
				            id: 'Logs_del_btn',
				            icon: 'img/del.png',
				            hidden:exists('Logs_del_btn'),
				            text: '删除'
				        },
				        {
                        	xtype: 'tbseparator',
                        	hidden:exists('Logs_del_btn')
                        },
				        {
				            xtype: 'button',
				            id: 'Logs_show_search_btn',
				            icon: 'img/search.png',
				            hidden:exists('Logs_show_search_btn'),
				            text: '高级查询'
				        },
				    ]
				},
				{
					xtype: 'form',
                    region: 'north',
                    frame: true,
                    height: 80,
                    layout: {
                        type: 'column'
                    },
                    hidden:true,
                    bodyPadding: 10,
                    margin: '0 2 2 2',
                    title: '高级查询',
				    id:'Logs_Search_Form',
				    items: [
				        {
				            xtype: 'combobox',
				            fieldLabel: '日志类别',
				            labelWidth: 70,
				            autoShow: true,
				            displayField: 'name',
                            valueField: 'id',
                            editable:false,
                            name:'logType',
                            store: Ext.create('Ext.data.Store', {
                                fields: ['id', 'name'],
                                data : [
                                    {"id":LOG_TYPE_SYSTEM, "name":"系统日志"},
                                    {"id":LOG_TYPE_ERROR, "name":"错误日志"},
                                    {"id":LOG_TYPE_OPERATE, "name":"操作日志"}
                                ]
                            })
				        },
				        {
				            xtype: 'textfield',
				            margin: '0 0 0 5',
				            fieldLabel: '操作人',
				            name:'logUserName',
				            labelWidth: 50
				        },
				        {
				            xtype: 'datefield',
				            margin: '0 0 0 5',
				            width: 170,
				            fieldLabel: '开始时间',
				            name:'startTime',
				            id:'search_log_startTime',
				            format:'Y-m-d',
				            labelWidth: 70,
				            listeners:{
                        		select:function(field,value,eOpts ){
								  var t = Ext.getCmp('search_log_endTime');  
					              var temp = Ext.Date.add(new Date(value),Ext.Date.DAY,1);  
					              t.setValue(temp);  
					              t.setMinValue(temp);  
                        		}
                        	}
				        },
				        {
				            xtype: 'datefield',
				            margin: '0 0 0 5',
				            width: 170,
				            fieldLabel: '结束时间',
				            name:"endTime",
				            id:'search_log_endTime',
				            format:'Y-m-d',
				            labelWidth: 70
				        },
				        {
				            xtype: 'button',
				            margin: '0 0 0 10',
				            icon: 'img/search.png',
				            id:"Logs_search_btn",
				            hidden:exists('Logs_search_btn'),
				            text: '查询'
				        },
				        {
				            xtype: 'button',
				            margin: '0 0 0 10',
				            icon: 'img/reset.png',
				            id:'Logs_reset_btn',
				            hidden:exists('Logs_reset_btn'),
				            text: '重置'
				        }
				    ]
				},
				{
				    xtype: 'gridpanel',
				    region: 'center',
				    id: 'LogGridPanel',
				    title: '系统操作日志',
				    margin:'0 2 2 2',
				    store:Ext.create("Logs.store.LogsStore",{autoLoad:true}),
				    columns: [
				        {
				            xtype: 'rownumberer',
				            width: 43,
				            text: '序号'
				        },
				        {
				            xtype: 'gridcolumn',
				            dataIndex: 'logUuid',
				            hidden: true,
				            hideable: false,
				            text: '日志Id'
				        },
				        {
				            xtype: 'gridcolumn',
				            dataIndex: 'logTitle',
				            text: '标题'
				        },
				        {
				            xtype: 'gridcolumn',
				            dataIndex: 'logType',
				            text: '类别',
				            renderer: function (data, metadata, record, rowIndex, columnIndex, store) { 
				        		if(data==LOG_TYPE_SYSTEM){
				        			return '系统日志'
				        		}
				        		if(data==LOG_TYPE_ERROR){
				        			return '错误日志';
				        		}
				        		if(data==LOG_TYPE_OPERATE){
				        			return '操作日志';
				        		}
		                  	}
				        },
				        {
				            xtype: 'gridcolumn',
				            dataIndex: 'logContent',
				            text: '操作内容'
				        },
				        {
				            xtype: 'gridcolumn',
				            dataIndex: 'logState',
				            text: '执行结果',
				            renderer: function (data, metadata, record, rowIndex, columnIndex, store) { 
				        		if(data==LOG_STATE_SUCCESS){
				        			return '<span style=\'color:green\'>执行成功</span>'
				        		}
				        		if(data==LOG_STATE_ERROR){
				        			return '<span style=\'color:red\'>执行失败</span>';
				        		}
		                  	}
				        },
				        {
				            xtype: 'gridcolumn',
				            dataIndex: 'logUserName',
				            text: '操作人'
				        },
				        {
				            xtype: 'gridcolumn',
				            dataIndex: 'logIp',
				            text: '操作人Id'
				        },
				        {
				            xtype: 'datecolumn',
				            dataIndex: 'createTime',
				            text: '操作时间',
				            renderer : Ext.util.Format.dateRenderer('Y-m-d H:i:s')
				            
				        }
				    ],
				    dockedItems: [
				        {
				            xtype: 'pagingtoolbar',
				            dock: 'bottom',
				            width: 360,
				            store:'LogsStore',
				            displayInfo: true
				        }
				    ]
				}
            ]
        });

        me.callParent(arguments);
    }

});